<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Agendamento Mídia</title>

  <link rel="stylesheet" href="style.css" />
  <link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
  <link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
  <link rel="manifest" href="site.webmanifest">

  <!-- FullCalendar CSS -->
  <link id="fc-cdn-css" href="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/main.min.css" rel="stylesheet" />

  <!-- Supabase (global) -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

  <!-- FullCalendar JS -->
  <script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/index.global.min.js"></script>
</head>
<body>
  <div class="container">
    <header class="topo">
      <img src="header.jpg" alt="Logo da mídia" class="midia-logo" />
    </header>

    <br><br><br><br>
    <div class="stack">
      <!-- Formulário de Agendamento -->
      <form id="form-agendamento" class="form-grid" autocomplete="off">
        <div class="form-group">
          <label for="professora">Agendante</label>
          <input type="text" id="professora" required />
        </div>

        <div class="form-group">
          <label for="turma">Turma</label>
          <input type="text" id="turma" required />
        </div>

        <div class="form-group">
          <label for="local">Local</label>
          <input type="text" id="local" required />
        </div>

        <div class="form-group">
          <label for="data">Data</label>
          <input type="date" id="data" required />
        </div>

        <div class="form-group">
          <label for="inicio">Início</label>
          <input type="time" id="inicio" required />
        </div>

        <div class="form-group">
          <label for="fim">Fim</label>
          <input type="time" id="fim" required />
        </div>

        <div class="form-group full-width">
          <label for="evento" class="center-label">Tipo de Evento</label>
          <input type="text" id="evento" required />
        </div>

        <div class="form-group full-width">
          <button type="submit">Agendar</button>
        </div>
      </form>

      <!-- Calendário -->
      <section aria-labelledby="titulo-calendario">
        <h2 id="titulo-calendario">Calendário de Agendamentos</h2>
        <div id="calendar"></div>
      </section>

      <!-- Lista de Agendamentos -->
      <section aria-labelledby="titulo-lista">
        <h2 id="titulo-lista">Lista de Agendamentos</h2>
        <div class="table-wrap">
          <table>
            <thead>
              <tr>
                <th>Agendante</th>
                <th>Turma</th>
                <th>Local</th>
                <th>Tipo de Evento</th>
                <th>Data</th>
                <th>Início</th>
                <th>Fim</th>
              </tr>
            </thead>
            <tbody id="lista-agendamentos"></tbody>
          </table>
        </div>
      </section>
    </div>
  </div>

  <!-- SIDEBAR: botão disparador e painel lateral -->
  <button id="btn-sidebar" class="btn-icone" aria-label="Abrir painel">
    <svg width="22" height="22" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
      <path d="M4 7H6L7 5H17L18 7H20C21.1 7 22 7.9 22 9V19C22 20.1 21.1 21 20 21H4C2.9 21 2 20.1 2 19V9C2 7.9 2.9 7 4 7Z" stroke="#fff" stroke-width="1" stroke-linecap="round" stroke-linejoin="round"/>
      <circle cx="12" cy="14" r="3.5" stroke="#fff" stroke-width="1"/>
    </svg>
  </button>

  <aside id="sidebar" class="sidebar" aria-hidden="true">
    <div class="sidebar-header">
      <button id="close-sidebar" class="close-sidebar" aria-label="Fechar painel">&times;</button>
      <h3>Painel</h3>
    </div>

    <div class="sidebar-section">
      <h4>Login do Administrador</h4>
      <form id="form-admin-login-sidebar" class="admin-sidebar-form">
        <label for="admin-senha-sidebar" class="sr-only">Senha de administrador</label>
        <input type="password" id="admin-senha-sidebar" placeholder="Senha de administrador" required />
        <button type="submit" class="btn-primary">Entrar</button>
      </form>
    </div>

    <div class="sidebar-section">
      <h4>Entrar em contato</h4>
      <p>Fale com a responsável pela mídia</p>
      <a id="btn-whatsapp" class="btn-whatsapp" href="https://wa.me/556183030004" target="_blank" rel="noopener noreferrer" aria-label="Abrir WhatsApp">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
          <path d="M21 12.08C21 17.09 16.97 21 12 21C8.95 21 6.1 19.42 4.5 17L3 21L6.12 19.59C7.14 20.17 8.35 20.5 9.66 20.5C14.68 20.5 19 16.18 19 11.16C19 10.07 18.85 9.02 18.56 8.03L21 6.5V12.08Z" stroke="#fff" stroke-width="0" fill="#25D366"/>
          <path d="M16.5 13.46C16.12 13.95 15.48 14.17 14.9 13.99C14.15 13.76 13.16 13.35 12.42 12.61C11.68 11.87 11.27 10.88 11.04 10.13C10.86 9.55 11.08 8.91 11.57 8.53L11.6 8.51C11.85 8.34 12.13 8.27 12.37 8.33C12.6 8.38 12.92 8.53 13.34 8.84C13.76 9.14 14.2 9.55 14.49 9.84C14.78 10.13 15.07 10.48 15.33 10.97C15.59 11.45 15.49 11.95 15.13 12.41L15.1 12.44C14.77 12.8 14.58 12.88 15.07 13.26Z" fill="#fff"/>
        </svg>
        <span>WhatsApp</span>
      </a>
    </div>
  </aside>

  <div id="sidebar-overlay" class="sidebar-overlay" aria-hidden="true"></div>

  <!-- Supabase Client e Script principal -->
  <script src="supabaseClient.js"></script>
  <script type="module" src="script.js"></script>

  <!-- Modal -->
  <div id="modal" class="modal" aria-hidden="true">
    <div class="modal-box" id="modal-content"></div>
  </div>

  <!-- Script sidebar / login -->
  <script>
    // SIDEBAR: abrir / fechar
    const btnSidebar = document.getElementById("btn-sidebar");
    const sidebar = document.getElementById("sidebar");
    const sidebarOverlay = document.getElementById("sidebar-overlay");
    const closeSidebarBtn = document.getElementById("close-sidebar");

    function abrirSidebar() {
      sidebar.classList.add("open");
      sidebarOverlay.classList.add("open");
      sidebar.setAttribute("aria-hidden", "false");
      sidebarOverlay.setAttribute("aria-hidden", "false");
    }
    function fecharSidebar() {
      sidebar.classList.remove("open");
      sidebarOverlay.classList.remove("open");
      sidebar.setAttribute("aria-hidden", "true");
      sidebarOverlay.setAttribute("aria-hidden", "true");
    }

    btnSidebar?.addEventListener("click", abrirSidebar);
    closeSidebarBtn?.addEventListener("click", fecharSidebar);
    sidebarOverlay?.addEventListener("click", fecharSidebar);

    // Login via sidebar: redireciona para admin.html quando correto
    document.getElementById("form-admin-login-sidebar").addEventListener("submit", function(e) {
      e.preventDefault();
      const senha = document.getElementById("admin-senha-sidebar").value;
      if (senha === "Midia123") {
        window.location.href = "admin.html";
      } else {
        alert("Senha incorreta.");
      }
    });
  </script>

  <!-- Script extra para tradução do calendário -->
  <script>
    document.addEventListener("DOMContentLoaded", function () {
      const calendarEl = document.getElementById("calendar");
      if (calendarEl) {
        const calendar = new FullCalendar.Calendar(calendarEl, {
          initialView: "timeGridWeek",
          locale: "pt-br"
        });
        calendar.render();
      }
    });
  </script>
</body>
</html>
